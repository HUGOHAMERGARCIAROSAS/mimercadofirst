var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};!function(o){"use strict";o.jscroll={defaults:{debug:!1,autoTrigger:!0,autoTriggerUntil:!1,loadingHtml:"<small>Loading...</small>",loadingFunction:!1,padding:0,nextSelector:"a:last",contentSelector:"",pagingSelector:"",callback:!1}};var n=function(n,t){var e,l=n.data("jscroll"),r="function"==typeof t?{callback:t}:t,i=o.extend({},o.jscroll.defaults,r,l||{}),c="visible"===n.css("overflow-y"),a=n.find(i.nextSelector).first(),s=o(window),d=o("body"),f=c?s:n,u=o.trim(a.prop("href")+" "+i.contentSelector),p=function(){n.find(".jscroll-inner").length||n.contents().wrapAll('<div class="jscroll-inner" />')},g=function(o){i.pagingSelector?o.closest(i.pagingSelector).hide():o.parent().not(".jscroll-inner,.jscroll-added").addClass("jscroll-next-parent").hide().length||o.wrap('<div class="jscroll-next-parent" />').parent().hide()},j=function(){return f.unbind(".jscroll").removeData("jscroll").find(".jscroll-inner").children().unwrap().filter(".jscroll-added").children().unwrap()},h=function(){if(n.is(":visible")){p();var o=n.find("div.jscroll-inner").first(),t=n.data("jscroll"),e=parseInt(n.css("borderTopWidth"),10),l=isNaN(e)?0:e,r=parseInt(n.css("paddingTop"),10)+l,a=c?f.scrollTop():n.offset().top,s=o.length?o.offset().top:0,d=Math.ceil(a-s+f.height()+r);if(!t.waiting&&d+i.padding>=o.outerHeight())return b("info","jScroll:",o.outerHeight()-d,"from bottom. Loading next request..."),v()}},y=function(){var t=n.find(i.nextSelector).first();if(t.length)if(i.autoTrigger&&(!1===i.autoTriggerUntil||0<i.autoTriggerUntil)){g(t);var e=d.height()-n.offset().top;(n.height()<e?n.height():e)<=(0<n.offset().top-s.scrollTop()?s.height()-(n.offset().top-o(window).scrollTop()):s.height())&&h(),f.unbind(".jscroll").bind("scroll.jscroll",function(){return h()}),0<i.autoTriggerUntil&&i.autoTriggerUntil--}else f.unbind(".jscroll"),t.bind("click.jscroll",function(){return g(t),v(),!1})},v=function(){var t=n.find("div.jscroll-inner").first(),e=n.data("jscroll");return e.waiting=!0,t.append('<div class="jscroll-added" />').children(".jscroll-added").last().html('<div class="jscroll-loading" id="jscroll-loading">'+i.loadingHtml+"</div>").promise().done(function(){i.loadingFunction&&i.loadingFunction()}),n.animate({scrollTop:t.outerHeight()},0,function(){var l=e.nextHref;t.find("div.jscroll-added").last().load(l,function(t,r){if("error"===r)return j();var c,a=o(this).find(i.nextSelector).first();e.waiting=!1,e.nextHref=!!a.prop("href")&&o.trim(a.prop("href")+" "+i.contentSelector),o(".jscroll-next-parent",n).remove(),(c=c||n.data("jscroll"))&&c.nextHref?y():(b("warn","jScroll: nextSelector not found - destroying"),j()),i.callback&&i.callback.call(this,l),b("dir",e)})})},b=function(o){if(i.debug&&"object"==("undefined"==typeof console?"undefined":_typeof(console))&&("object"==(void 0===o?"undefined":_typeof(o))||"function"==typeof console[o]))if("object"==(void 0===o?"undefined":_typeof(o))){var n=[];for(var t in o)"function"==typeof console[t]?(n=o[t].length?o[t]:[o[t]],console[t].apply(console,n)):console.log.apply(console,n)}else console[o].apply(console,Array.prototype.slice.call(arguments,1))};return n.data("jscroll",o.extend({},l,{initialized:!0,waiting:!1,nextHref:u})),p(),(e=o(i.loadingHtml).filter("img").attr("src"))&&((new Image).src=e),y(),o.extend(n.jscroll,{destroy:j}),n};o.fn.jscroll=function(t){return this.each(function(){var e=o(this),l=e.data("jscroll");l&&l.initialized||n(e,t)})}}(jQuery);